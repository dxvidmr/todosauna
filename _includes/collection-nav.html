<div class="nav-wrapper text-dark">
    <div class="nav-backdrop" id="navBackdrop"></div>
    <nav class="navbar navbar-floating {{ site.data.theme.navbar-color | default: 'navbar-dark' }} {{ site.data.theme.navbar-background | default: 'bg-dark' }}" id="mainNav">
        <div class="navbar-header">
            <a class="navbar-brand" href="{{ '/' | relative_url }}">{{ site.title }}</a>
            
            <!-- Desktop navigation - visible on large screens -->
            <div class="d-none d-lg-flex navbar-nav-desktop">
                <a class="nav-link{% if page.url == '/lectura/' %} active{% endif %}" href="{{ '/lectura/' | relative_url }}">Lectura</a>
                <a class="nav-link{% if page.url == '/archivo/' %} active{% endif %}" href="{{ '/archivo/' | relative_url }}">Archivo</a>
                <a class="nav-link{% if page.url == '/participa/' %} active{% endif %}" href="{{ '/participa/' | relative_url }}">Participa</a>
                <a class="nav-link{% if page.url == '/acerca-de/' %} active{% endif %}" href="{{ '/acerca-de/' | relative_url }}">Acerca de</a>
                {% if page.layout == 'lectura' or page.layout == 'laboratorio' %}
                <button id="btn-modo-usuario" class="btn-modo-usuario ms-2">
                    <i class="fa-solid fa-user" aria-hidden="true"></i> Mi participación
                </button>
                {% endif %}
            </div>

            <!-- Hamburger/Close button -->
            <button class="navbar-toggler" type="button" id="navToggle" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
                <span class="navbar-close-icon">&times;</span>
            </button>
        </div>

        <!-- Expanded menu content -->
        <div class="navbar-expanded text-dark" id="navExpanded">
            <div class="navbar-expanded-grid">
                <div class="navbar-expanded-column">
                    <a href="{{ '/lectura/' | relative_url }}" class="navbar-expanded-title{% if page.url == '/lectura/' %} active{% endif %}">Lectura</a>
                    <ul class="navbar-expanded-links">
                        <li><a href="{{ '/browse.html' | relative_url }}">Explorar colección</a></li>
                        <li><a href="{{ '/subjects.html' | relative_url }}">Por temas</a></li>
                        <li><a href="{{ '/timeline.html' | relative_url }}">Línea de tiempo</a></li>
                    </ul>
                </div>
                
                <div class="navbar-expanded-column">
                    <a href="{{ '/archivo/' | relative_url }}" class="navbar-expanded-title{% if page.url == '/archivo/' %} active{% endif %}">Archivo</a>
                    <ul class="navbar-expanded-links">
                        <li><a href="{{ '/locations.html' | relative_url }}">Por ubicaciones</a></li>
                        <li><a href="{{ '/data.html' | relative_url }}">Datos y metadatos</a></li>
                    </ul>
                </div>
                
                <div class="navbar-expanded-column">
                    <a href="{{ '/participa/' | relative_url }}" class="navbar-expanded-title{% if page.url == '/participa/' %} active{% endif %}">Participa</a>
                    <ul class="navbar-expanded-links">
                        <li><a href="{{ '/participa/laboratorio/' | relative_url }}">Laboratorio de notas</a></li>
                        <li><a href="#">Contribuye con contenido</a></li>
                        <li><a href="#">Contacto</a></li>
                    </ul>
                </div>
                
                <div class="navbar-expanded-column">
                    <a href="{{ '/acerca-de/' | relative_url }}" class="navbar-expanded-title{% if page.url == '/acerca-de/' %} active{% endif %}">Acerca de</a>
                    <ul class="navbar-expanded-links">
                        <li><a href="{{ '/about.html' | relative_url }}">Sobre el proyecto</a></li>
                        <li><a href="#">Equipo</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="navbar-expanded-search">
                {% include nav-search-lunr.html %}
            </div>
        </div>
    </nav>
</div>

<script>
    // Toggle expanded menu
    document.getElementById('navToggle').addEventListener('click', function() {
        const nav = document.getElementById('mainNav');
        const backdrop = document.getElementById('navBackdrop');
        nav.classList.toggle('expanded');
        backdrop.classList.toggle('active');
    });
    
    // Close on backdrop click
    document.getElementById('navBackdrop').addEventListener('click', function() {
        document.getElementById('mainNav').classList.remove('expanded');
        this.classList.remove('active');
    });
    
    // Close on escape key
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            document.getElementById('mainNav').classList.remove('expanded');
            document.getElementById('navBackdrop').classList.remove('active');
        }
    });
</script>
